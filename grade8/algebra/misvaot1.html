<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <script>
        // --- 专转 ---
        const SESSION_KEY = 'access_grade8'; // 砖 -'access_grade9'   拽抓 砖 转 '
        const LOGIN_PAGE = '../index8.html'; // 砖 -'../index9.html'   转 '
        const TIMEOUT_MINUTES = 30;

        // 1. 拽转 住
        if (sessionStorage.getItem(SESSION_KEY) !== 'true') {
            window.location.replace(LOGIN_PAGE);
        }

        // 2. 转拽 
        let inactivityTimer;
        function resetTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                sessionStorage.removeItem(SESSION_KEY);
                window.location.replace(LOGIN_PAGE);
            }, TIMEOUT_MINUTES * 60 * 1000);
        }

        window.addEventListener('load', resetTimer);
        document.addEventListener('mousemove', resetTimer);
        document.addEventListener('keypress', resetTimer);
        document.addEventListener('click', resetTimer);
        document.addEventListener('touchstart', resetTimer);

        // 3. 住转 F12
        document.addEventListener('contextmenu', event => event.preventDefault());
        document.addEventListener('keydown', event => {
            if (event.key === 'F12' ||
                (event.ctrlKey && event.shiftKey && (event.key === 'I' || event.key === 'J' || event.key === 'C')) ||
                (event.ctrlKey && event.key === 'u')) {
                event.preventDefault();
            }
        });
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>砖转 专注 砖</title>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Rubik', sans-serif;
            background-color: #f8fafc;
        }

        .math-term {
            font-family: 'Rubik', sans-serif;
            direction: ltr;
            display: inline-block;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Custom scrollbar for better UX */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col">
    <div id="root" class="flex-grow"></div>

    <!-- 驻专 拽注 -->
    <footer class="bg-slate-800 text-slate-400 text-center py-4 text-sm mt-auto">
        <p>漏  转 砖专转 专</p>
    </footer>

    <script type="text/babel">
        const { useState } = React;

        // --- 拽 ---
        const IconBook = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>;
        const IconPencil = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>;
        const IconCheck = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className="text-green-600"><polyline points="20 6 9 17 4 12"></polyline></svg>;
        const IconX = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className="text-red-600"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const IconArrowLeft = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>;
        const IconTrophy = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8 21h8m-4-9v9m-4.8-9A4.8 4.8 0 0112 7.2 4.8 4.8 0 0116.8 12M3 12h.01M21 12h.01M3 7h.01M21 7h.01"></path><path d="M8 21h8"></path><path d="M12 17a5 5 0 0 0 5-5c0-2.76-2.24-5-5-5s-5 2.24-5 5a5 5 0 0 0 5 5z"></path></svg>;
        const IconBulb = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-yellow-500"><line x1="9" y1="18" x2="15" y2="18"></line><line x1="10" y1="22" x2="14" y2="22"></line><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 16.5 8 4.5 4.5 0 0 0 12 3.5 4.5 4.5 0 0 0 7.5 8c0 1.16.52 2.17 1.41 2.5A6.9 6.9 0 0 1 10 14"></path></svg>;
        const IconHome = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>;

        // --- 转  ---
        const lessons = [
            {
                id: 1,
                title: "砖 1: 砖转 住住转",
                subtitle: "专: 拽住 爪 , 住驻专 爪 砖",
                content: (
                    <div className="space-y-6 text-lg">
                        <p>
                            砖   . 专 砖 转 : <strong>驻专 转</strong>.
                             专爪 转 -X  爪 , 转 住驻专 专 爪 砖.
                        </p>
                        <div className="bg-white p-6 rounded-2xl border-r-8 border-blue-500 shadow-sm">
                            <h4 className="font-bold text-blue-700 mb-2 text-xl">: 注专转 驻</h4>
                            <p> 注专 住驻专 爪 砖 ("爪 砖 住驻专"),  爪注 转 驻注 驻:</p>
                            <ul className="list-disc list-inside mt-2 text-gray-700">
                                <li>驻 -<strong>驻住 (+)</strong>  <strong>住 (-)</strong>.</li>
                                <li>驻 -<strong>住 (-)</strong>  <strong>驻住 (+)</strong>.</li>
                            </ul>
                        </div>
                        <div className="bg-blue-50 p-6 rounded-2xl">
                            <h4 className="font-bold mb-4 border-b border-blue-200 pb-2 text-blue-800">:</h4>
                            <div className="flex flex-col gap-3 items-center font-bold text-3xl" dir="ltr">
                                <div className="math-term text-gray-800">x + 3 = 7</div>
                                <div className="text-base text-gray-500 font-normal bg-white px-3 py-1 rounded-full shadow-sm">注专 转 -3 爪 砖 住驻专 (住)</div>
                                <div className="math-term text-blue-600">x = 7 - 3</div>
                                <div className="math-term bg-blue-100 px-6 py-2 rounded-xl text-blue-800 border border-blue-200">x = 4</div>
                            </div>
                        </div>
                    </div>
                )
            },
            {
                id: 2,
                title: "砖 2: 驻 拽",
                subtitle: " 转 -X 住驻专 砖拽 ",
                content: (
                    <div className="space-y-6 text-lg">
                        <p>
                              专  砖专 转 -X <strong>专 </strong>.
                            砖砖 住驻专 爪 -X (砖 <span className="math-term font-bold">2x</span>),  专 砖砖  驻.
                        </p>
                        <div className="bg-white p-6 rounded-2xl border-r-8 border-purple-500 shadow-sm">
                            <h4 className="font-bold text-purple-700 mb-2 text-xl">: 拽 拽</h4>
                            <p> 驻专 驻 砖专 转 -X , 注砖 拽.</p>
                            <p>转 拽 转 住驻专 砖爪 砖 住驻专 砖爪 -X.</p>
                        </div>
                        <div className="bg-purple-50 p-6 rounded-2xl">
                            <h4 className="font-bold mb-4 border-b border-purple-200 pb-2 text-purple-800">:</h4>
                            <div className="flex flex-col gap-3 items-center font-bold text-3xl" dir="ltr">
                                <div className="math-term text-gray-800">2x = 10</div>
                                <div className="text-base text-gray-500 font-normal bg-white px-3 py-1 rounded-full shadow-sm">拽 转 10 -2</div>
                                <div className="math-term text-purple-600">x = 10 : 2</div>
                                <div className="math-term bg-purple-100 px-6 py-2 rounded-xl text-purple-800 border border-purple-200">x = 5</div>
                            </div>
                        </div>
                    </div>
                )
            },
            {
                id: 3,
                title: "砖 3: 砖转 砖转",
                subtitle: "拽住 , 住驻专 砖 ( 驻)",
                content: (
                    <div className="space-y-6 text-lg">
                        <p>
                             砖 砖 转专! 专: <strong>住专 </strong>.  拽住 爪专 专 爪 ,  住驻专 爪 砖.
                        </p>
                        <div className="bg-white p-6 rounded-2xl border-r-8 border-green-500 shadow-sm">
                            <h4 className="font-bold text-green-700 mb-2 text-xl">驻 砖: 注专转 拽住</h4>
                            <p>驻砖专 注专 拽住 祝 祝 拽  住驻专!</p>
                            <p> 砖  <span className="math-term text-green-600 font-bold">2x</span> 爪 , 注专 转 爪 砖 -<span class="math-term text-red-500 font-bold">-2x</span>.</p>
                            <hr class="my-3 border-gray-200" />
                            <h4 className="font-bold text-green-700 mb-2 text-xl"> 专 拽住?</h4>
                            <p>驻砖 : 专 转 住驻专 (拽) -X 砖专.</p>
                            <p class="text-center bg-gray-100 p-2 rounded mt-2 font-mono" dir="ltr">3x + 2x = (3+2)x = 5x</p>
                        </div>
                        <div className="bg-green-50 p-6 rounded-2xl">
                            <h4 className="font-bold mb-4 border-b border-green-200 pb-2 text-green-800"> 住专 驻:</h4>
                            <div className="flex flex-col gap-2 items-center font-bold text-2xl" dir="ltr">
                                <div className="math-term text-gray-800">5x = 3x + 12</div>
                                <div className="text-sm text-gray-500 font-normal">注专 转 -3x 砖 (住)</div>
                                <div className="math-term text-green-600">5x - 3x = 12</div>
                                <div className="math-term text-gray-800">2x = 12</div>
                                <div className="math-term bg-green-100 px-6 py-2 rounded-xl text-green-800 border border-green-200">x = 6</div>
                            </div>
                        </div>
                    </div>
                )
            },
            {
                id: 4,
                title: "砖 4: 拽 驻",
                subtitle: "驻转 住专 驻 砖住专",
                content: (
                    <div className="space-y-6 text-lg">
                        <p>
                            驻注 砖 "专" 住专. 砖 专砖  转 驻转 转  砖 注专 驻.
                        </p>
                        <div className="bg-white p-6 rounded-2xl border-r-8 border-orange-500 shadow-sm">
                            <h4 className="font-bold text-orange-700 mb-2 text-xl"> 驻转?</h4>
                            <p>住驻专 砖抓 驻 转 <strong></strong>  砖驻 -  转 -X  转 住驻专.</p>
                            <div className="mt-3 text-xl font-mono text-center bg-gray-100 p-3 rounded-lg border border-gray-200" dir="ltr">3(x + 4) = 3x + 12</div>
                        </div>
                        <div className="bg-orange-50 p-6 rounded-2xl">
                            <h4 className="font-bold mb-4 border-b border-orange-200 pb-2 text-orange-800"> :</h4>
                            <div className="flex flex-col gap-2 items-center font-bold text-2xl" dir="ltr">
                                <div className="math-term text-gray-800">2(x - 3) = 10</div>
                                <div className="text-sm text-gray-500 font-normal">砖 1: 驻转转 住专</div>
                                <div className="math-term text-orange-600">2x - 6 = 10</div>
                                <div className="text-sm text-gray-500 font-normal">砖 2: 注专转 住驻专 (-6 注专 驻住)</div>
                                <div className="math-term text-gray-800">2x = 16</div>
                                <div className="math-term bg-orange-100 px-6 py-2 rounded-xl text-orange-800 border border-orange-200">x = 8</div>
                            </div>
                        </div>
                    </div>
                )
            }
        ];

        // --- 砖转 转专 ---
        const practiceQuestions = [
            // 专 1
            { level: 1, q: "x + 60 = 78", options: ["18", "138", "-18", "60"], correct: 0, explanation: "注专 转 -60 爪 砖 住驻专 住专. 78 驻转 60 砖 18." },
            { level: 1, q: "x - 14 = 6", options: ["8", "-8", "20", "-20"], correct: 2, explanation: "注专 转 -14 爪 砖 住驻专 驻住. 6 注 14 砖 20." },
            { level: 1, q: "x + 3 = -9", options: ["-6", "-12", "12", "6"], correct: 1, explanation: "住 9 驻转 3 转 住 12." },
            // 专 2
            { level: 2, q: "5x = 20", options: ["4", "100", "15", "25"], correct: 0, explanation: "拽 -5   转 -x. 20 拽 -5  4." },
            { level: 2, q: "-4x = 16", options: ["4", "-4", "12", "-12"], correct: 1, explanation: "16 拽 住 4  住 4." },
            { level: 2, q: "2x = -10", options: ["-5", "5", "-20", "-8"], correct: 0, explanation: "住 10 拽 -2  住 5." },
            // 专 3
            { level: 3, q: "2x + 3 = 9", options: ["3", "6", "2", "4"], correct: 0, explanation: "拽 注专 住驻专: 注专 3 (拽 6),  拽 -2 拽 3." },
            { level: 3, q: "3x - 55 = -25", options: ["10", "30", "-10", "-30"], correct: 0, explanation: "注专 55 驻住 (拽 30), 拽 -3 拽 10." },
            { level: 3, q: "6x + 5 = 17", options: ["2", "12", "3", "1"], correct: 0, explanation: "注专 5 住专 (拽 12), 拽 -6 拽 2." },
            // 专 4
            { level: 4, q: "3(x - 8) = 6", options: ["10", "14", "-6", "2"], correct: 0, explanation: "驻转 住专: 3x - 24 = 6. 注专 转 -24 爪 住驻专 驻住 (拽 30), 拽 -3 拽 10." },
            { level: 4, q: "2(x - 3) = 6", options: ["6", "9", "3", "0"], correct: 0, explanation: "驻转 住专: 2x - 6 = 6. 注专 6 (拽 12), 拽 -2 拽 6." },
            { level: 4, q: "5(x - 2) + 4 = 19", options: ["5", "3", "7", "4"], correct: 0, explanation: "驻转: 5x - 10 + 4 = 19 -> 住专 住驻专: 5x - 6 = 19. 注专 6 (拽 25), 拽 -5." }
        ];

        // --- 砖转  住 (15 砖转 注专转) ---
        const finalQuizQuestions = [
            { id: 1, q: "x + 7 = 15", options: ["8", "22", "-8", "7"], correct: 0, hint: "注专 转 -7 爪 砖 住驻专 住专.", explanation: "15 驻转 7 砖 8." },
            { id: 2, q: "x - 9 = 2", options: ["7", "11", "-7", "18"], correct: 1, hint: "注专 转 -9 爪 砖 驻住.", explanation: "2 注 9 砖 11." },
            { id: 3, q: "5x = 30", options: ["25", "150", "6", "5"], correct: 2, hint: "住驻专 5 拽 -x 驻. 驻注 驻  拽.", explanation: "30 拽 -5 砖 6." },
            { id: 4, q: "-2x = 10", options: ["5", "-5", "12", "-20"], correct: 1, hint: "专:  拽 砖 砖 砖.", explanation: "10 拽 住 2 砖 住 5." },
            { id: 5, q: "3x + 4 = 19", options: ["5", "7.6", "15", "23"], correct: 0, hint: "拽 驻专 -4 (住驻专 驻砖), 专拽 住祝 拽 -3.", explanation: "3x=15,  x=5." },
            { id: 6, q: "4x - 5 = 15", options: ["20", "5", "2.5", "10"], correct: 1, hint: "注专 转 -5 住 驻 (驻住).", explanation: "4x=20,  x=5." },
            { id: 7, q: "6x + 2 = 20", options: ["3", "18", "3.6", "2"], correct: 0, hint: "专: 拽住 爪 , 住驻专 爪 砖.", explanation: "6x=18,  x=3." },
            { id: 8, q: "2(x + 4) = 18", options: ["5", "7", "9", "14"], correct: 0, hint: "驻转 住专: 2 驻 x -2 驻 4.", explanation: "2x+8=18 -> 2x=10 -> x=5." },
            { id: 9, q: "5(x - 1) = 20", options: ["4", "5", "3", "25"], correct: 1, hint: "砖转砖 拽 驻 驻转转 住专.", explanation: "5x-5=20 -> 5x=25 -> x=5." },
            { id: 10, q: "3x + 2x = 25", options: ["5", "25", "1", "50"], correct: 0, hint: "专 转 拽住: 3 转驻 注 2 转驻  5 转驻.", explanation: "5x=25,  x=5." },
            { id: 11, q: "3(2x + 1) = 21", options: ["3", "4", "10", "6"], correct: 0, hint: "砖 : -3 驻  转 -2x  转 -1.", explanation: "6x+3=21 -> 6x=18 -> x=3." },
            { id: 12, q: "4(x - 2) + 5 = 17", options: ["5", "3", "6", "4"], correct: 0, hint: "住专 驻注转: 1. 住专 2. 住 住驻专 3. 注专转 驻.", explanation: "4x-8+5=17 -> 4x-3=17 -> 4x=20 -> x=5." },
            { id: 13, q: "住驻专 驻 4, 注 6, 砖 30.  住驻专?", options: ["6", "24", "9", "7.5"], correct: 0, hint: "转 砖: 4x + 6 = 30", explanation: "4x=24 -> x=6." },
            { id: 14, q: "4x + 2 = 2x + 10", options: ["4", "2", "6", "3"], correct: 0, hint: "注专 转 -2x 爪 砖 (住) 转 -2 爪  (住).", explanation: "注专 拽住 砖: 4x-2x=2x. 注专 住驻专 : 10-2=8. 拽 2x=8,  x=4." },
            { id: 15, q: "5x = 3x + 12", options: ["6", "4", "12", "-6"], correct: 0, hint: "注专 转 -3x 爪 砖 住专  砖 拽住  .", explanation: "5x - 3x = 12 -> 2x=12 -> x=6." }
        ];

        // --- 专  (Lesson) ---
        const LessonView = ({ lesson, onComplete }) => {
            return (
                <div className="fade-in max-w-3xl mx-auto bg-white rounded-3xl shadow-xl overflow-hidden border border-indigo-50">
                    <div className="bg-indigo-600 p-8 text-white text-center relative overflow-hidden">
                        <div className="absolute top-0 left-0 w-full h-full opacity-10 bg-[url('https://www.transparenttextures.com/patterns/graphy.png')]"></div>
                        <h2 className="text-3xl font-black mb-2 relative z-10">{lesson.title}</h2>
                        <p className="text-indigo-100 text-xl relative z-10">{lesson.subtitle}</p>
                    </div>
                    <div className="p-10">
                        {lesson.content}
                        <button
                            onClick={onComplete}
                            className="mt-10 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-2xl transition-all transform hover:scale-[1.02] shadow-lg text-xl flex items-center justify-center gap-3"
                        >
                            转,  转专! <IconArrowLeft />
                        </button>
                    </div>
                </div>
            );
        };

        // --- 专 转专 专 (Quiz) ---
        const QuizView = ({ level, onBack }) => {
            const levelQuestions = practiceQuestions.filter(q => q.level === level);
            const [currentQIndex, setCurrentQIndex] = useState(0);
            const [selectedOption, setSelectedOption] = useState(null);
            const [score, setScore] = useState(0);
            const [showSummary, setShowSummary] = useState(false);

            const question = levelQuestions[currentQIndex];

            const handleAnswer = (index) => {
                if (selectedOption !== null) return;
                setSelectedOption(index);
                if (index === question.correct) setScore(score + 1);
            };

            const nextQuestion = () => {
                if (currentQIndex < levelQuestions.length - 1) {
                    setCurrentQIndex(currentQIndex + 1);
                    setSelectedOption(null);
                } else {
                    setShowSummary(true);
                }
            };

            if (showSummary) {
                return (
                    <div className="fade-in max-w-xl mx-auto bg-white rounded-3xl shadow-2xl p-10 text-center border-t-8 border-indigo-500">
                        <div className="text-7xl mb-6 animate-bounce"></div>
                        <h2 className="text-4xl font-black text-gray-800 mb-4">住转 转 转专!</h2>
                        <p className="text-2xl text-gray-600 mb-8">注转  注 <span className="font-black text-indigo-600">{score}</span> 转 <span className="font-black text-indigo-600">{levelQuestions.length}</span> 砖转.</p>
                        <button onClick={onBack} className="bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-4 px-10 rounded-2xl transition-all text-lg shadow-sm border border-gray-300">
                            专 转驻专 专砖
                        </button>
                    </div>
                );
            }

            return (
                <div className="fade-in max-w-3xl mx-auto">
                    <div className="flex justify-between items-center mb-8 px-4">
                        <span className="bg-white text-indigo-800 px-5 py-2 rounded-full font-bold shadow-sm border border-indigo-100 text-lg">砖 {currentQIndex + 1} / {levelQuestions.length}</span>
                        <span className="text-gray-500 font-bold text-lg">专 {level}</span>
                    </div>

                    <div className="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden">
                        <div className="p-12 text-center border-b border-gray-100 bg-gray-50">
                            <h3 className="text-5xl font-black text-gray-800 math-term dir-ltr tracking-wide drop-shadow-sm">
                                {question.q}
                            </h3>
                        </div>

                        <div className="p-8 grid grid-cols-1 md:grid-cols-2 gap-5">
                            {question.options.map((opt, idx) => {
                                let btnClass = "w-full p-6 text-2xl font-bold rounded-2xl border-2 transition-all duration-200 flex justify-between items-center ";
                                if (selectedOption === null) {
                                    btnClass += "border-gray-200 hover:border-indigo-400 hover:bg-indigo-50 text-gray-700 hover:shadow-md cursor-pointer";
                                } else if (idx === question.correct) {
                                    btnClass += "bg-green-50 border-green-500 text-green-800 shadow-inner";
                                } else if (idx === selectedOption) {
                                    btnClass += "bg-red-50 border-red-500 text-red-800";
                                } else {
                                    btnClass += "border-gray-100 text-gray-400 opacity-50 cursor-not-allowed";
                                }

                                return (
                                    <button
                                        key={idx}
                                        onClick={() => handleAnswer(idx)}
                                        className={btnClass}
                                        disabled={selectedOption !== null}
                                        dir="ltr"
                                    >
                                        <span className="text-center w-full">{opt}</span>
                                        {selectedOption !== null && idx === question.correct && <IconCheck />}
                                        {selectedOption === idx && idx !== question.correct && <IconX />}
                                    </button>
                                );
                            })}
                        </div>

                        {selectedOption !== null && (
                            <div className="bg-blue-50 p-8 border-t border-blue-100 animate-in fade-in">
                                <div className="flex items-start gap-4">
                                    <div className="mt-1 p-2 bg-blue-200 rounded-full text-blue-800"><IconBook /></div>
                                    <div>
                                        <h4 className="font-bold text-blue-900 text-xl mb-2">住专 驻转专:</h4>
                                        <p className="text-blue-800 leading-relaxed text-lg">{question.explanation}</p>
                                    </div>
                                </div>
                                <button
                                    onClick={nextQuestion}
                                    className="mt-8 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg transition-all flex justify-center items-center gap-3 text-xl"
                                >
                                    砖  <IconArrowLeft />
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- 专  住 (砖!) ---
        const FinalTestView = ({ onBack }) => {
            const [currentQIndex, setCurrentQIndex] = useState(0);
            const [selectedOption, setSelectedOption] = useState(null);
            const [score, setScore] = useState(0);
            const [showSummary, setShowSummary] = useState(false);
            const [hintShown, setHintShown] = useState(false);

            const question = finalQuizQuestions[currentQIndex];

            const handleAnswer = (index) => {
                if (selectedOption !== null) return;
                setSelectedOption(index);
                if (index === question.correct) setScore(score + 1);
            };

            const nextQuestion = () => {
                if (currentQIndex < finalQuizQuestions.length - 1) {
                    setCurrentQIndex(currentQIndex + 1);
                    setSelectedOption(null);
                    setHintShown(false);
                } else {
                    setShowSummary(true);
                }
            };

            if (showSummary) {
                const percentage = Math.round((score / finalQuizQuestions.length) * 100);
                let message = "";
                if (percentage >= 90) message = "驻转 注! ";
                else if (percentage >= 70) message = " ! 注  ";
                else message = "转 ,  专 注 专 ";

                return (
                    <div className="fade-in max-w-xl mx-auto bg-white rounded-3xl shadow-2xl p-12 text-center border-t-8 border-indigo-500 mt-10">
                        <div className="text-8xl mb-6"></div>
                        <h2 className="text-4xl font-black text-indigo-900 mb-4">转爪转 </h2>
                        <div className="text-6xl font-black text-indigo-600 mb-4">{percentage}%</div>
                        <p className="text-xl text-gray-600 mb-8">{message}<br />注转  注 {score} 转 {finalQuizQuestions.length} 砖转.</p>
                        <button onClick={onBack} className="bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-4 px-12 rounded-2xl transition-all text-xl shadow-sm border border-gray-300">
                            住 专
                        </button>
                    </div>
                );
            }

            return (
                <div className="fade-in max-w-3xl mx-auto">
                    <div className="flex justify-between items-center mb-8 px-4">
                        <span className="bg-indigo-600 text-white px-5 py-2 rounded-full font-bold shadow-md text-lg">砖 {currentQIndex + 1} / {finalQuizQuestions.length}</span>
                        <div className="flex gap-2">
                            {Array.from({ length: finalQuizQuestions.length }).map((_, i) => (
                                <div key={i} className={`h-2 w-2 rounded-full ${i < currentQIndex ? 'bg-indigo-600' : 'bg-gray-300'} hidden md:block`}></div>
                            ))}
                        </div>
                        <span className="text-indigo-900 font-bold text-lg flex items-center gap-2"><IconTrophy />  住</span>
                    </div>

                    <div className="bg-white rounded-3xl shadow-xl border border-indigo-50 overflow-hidden relative">
                        {/* 驻住 转拽转 注 */}
                        <div className="absolute top-0 right-0 h-2 bg-indigo-600 transition-all duration-500" style={{ width: `${((currentQIndex + 1) / finalQuizQuestions.length) * 100}%` }}></div>

                        <div className="p-12 text-center border-b border-gray-100 bg-gray-50">
                            <h3 className="text-5xl font-black text-gray-800 math-term dir-ltr tracking-wide">
                                {question.q}
                            </h3>
                        </div>

                        <div className="p-8">
                            {/* 专 专 */}
                            <div className="mb-6 flex justify-center">
                                {!hintShown && selectedOption === null ? (
                                    <button
                                        onClick={() => setHintShown(true)}
                                        className="text-yellow-600 font-bold flex items-center gap-2 hover:bg-yellow-50 px-4 py-2 rounded-xl transition-colors"
                                    >
                                        <IconBulb /> 爪专 专?
                                    </button>
                                ) : hintShown && selectedOption === null ? (
                                    <div className="bg-yellow-50 text-yellow-800 px-6 py-3 rounded-xl border border-yellow-200 animate-in fade-in flex items-center gap-3">
                                        <IconBulb />
                                        <span><strong>专:</strong> {question.hint}</span>
                                    </div>
                                ) : null}
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-5">
                                {question.options.map((opt, idx) => {
                                    let btnClass = "w-full p-6 text-2xl font-bold rounded-2xl border-2 transition-all duration-200 flex justify-between items-center ";
                                    if (selectedOption === null) {
                                        btnClass += "border-gray-200 hover:border-indigo-400 hover:bg-indigo-50 text-gray-700 hover:shadow-md cursor-pointer";
                                    } else if (idx === question.correct) {
                                        btnClass += "bg-green-50 border-green-500 text-green-800 shadow-inner";
                                    } else if (idx === selectedOption) {
                                        btnClass += "bg-red-50 border-red-500 text-red-800";
                                    } else {
                                        btnClass += "border-gray-100 text-gray-400 opacity-50 cursor-not-allowed";
                                    }

                                    return (
                                        <button
                                            key={idx}
                                            onClick={() => handleAnswer(idx)}
                                            className={btnClass}
                                            disabled={selectedOption !== null}
                                            dir="ltr"
                                        >
                                            <span className="text-center w-full">{opt}</span>
                                            {selectedOption !== null && idx === question.correct && <IconCheck />}
                                            {selectedOption === idx && idx !== question.correct && <IconX />}
                                        </button>
                                    );
                                })}
                            </div>
                        </div>

                        {selectedOption !== null && (
                            <div className="bg-indigo-50 p-8 border-t border-indigo-100 animate-in fade-in">
                                <div className="flex items-start gap-4">
                                    <div className="mt-1 p-2 bg-indigo-200 rounded-full text-indigo-800"><IconBook /></div>
                                    <div>
                                        <h4 className="font-bold text-indigo-900 text-xl mb-2">住专 :</h4>
                                        <p className="text-indigo-800 leading-relaxed text-lg">{question.explanation}</p>
                                    </div>
                                </div>
                                <button
                                    onClick={nextQuestion}
                                    className="mt-8 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg transition-all flex justify-center items-center gap-3 text-xl"
                                >
                                    {currentQIndex < finalQuizQuestions.length - 1 ? "砖 " : "住 拽转 爪"} <IconArrowLeft />
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- 驻拽爪 专砖转 ---
        const App = () => {
            const [view, setView] = useState('menu'); // menu, learn, quiz, final_test
            const [activeLevel, setActiveLevel] = useState(1);

            const startLearning = (level) => {
                setActiveLevel(level);
                setView('learn');
            };

            const startQuiz = (level) => {
                setActiveLevel(level);
                setView('quiz');
            };

            const startFinalTest = () => {
                setView('final_test');
            };

            const backToMenu = () => {
                setView('menu');
            };

            // 住 转驻专 专砖
            if (view === 'menu') {
                return (
                    <div className="max-w-5xl mx-auto px-4 py-12">
                        {/* 住驻转 驻转专 爪  */}
                        <div className="absolute top-4 left-4">
                            <a href="../index.html" className="flex items-center gap-2 text-gray-500 hover:text-indigo-600 font-bold bg-white px-4 py-2 rounded-xl shadow-sm border border-gray-200 transition-all hover:shadow-md">
                                <IconHome /> 专  转 '
                            </a>
                        </div>

                        <header className="text-center mb-16">
                            <h1 className="text-5xl md:text-6xl font-black text-indigo-900 mb-4 tracking-tight">砖转 专注 砖</h1>
                            <p className="text-2xl text-gray-600 font-light">专  爪 专 - 转 '</p>
                        </header>

                        <div className="grid md:grid-cols-2 lg:grid-cols-2 gap-8 mb-12">
                            {lessons.map((lesson) => (
                                <div key={lesson.id} className="bg-white rounded-3xl shadow-xl overflow-hidden border border-indigo-50 transition-all hover:shadow-2xl hover:-translate-y-2 group">
                                    <div className="p-8">
                                        <div className="flex justify-between items-start mb-6">
                                            <span className="bg-indigo-100 text-indigo-800 text-base font-bold px-4 py-1.5 rounded-full">砖 {lesson.id}</span>
                                        </div>
                                        <h3 className="text-3xl font-black text-gray-800 mb-3 group-hover:text-indigo-600 transition-colors">{lesson.title.split(': ')[1]}</h3>
                                        <p className="text-gray-500 mb-8 text-lg">{lesson.subtitle}</p>

                                        <div className="flex gap-4">
                                            <button
                                                onClick={() => startLearning(lesson.id)}
                                                className="flex-1 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 font-bold py-4 px-4 rounded-2xl flex items-center justify-center gap-2 transition-colors text-lg"
                                            >
                                                <IconBook /> 
                                            </button>
                                            <button
                                                onClick={() => startQuiz(lesson.id)}
                                                className="flex-1 bg-white border-2 border-indigo-600 text-indigo-600 hover:bg-indigo-600 hover:text-white font-bold py-4 px-4 rounded-2xl flex items-center justify-center gap-2 transition-all text-lg"
                                            >
                                                <IconPencil /> 转专
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>

                        {/* 驻转专  住 */}
                        <div className="max-w-3xl mx-auto">
                            <button
                                onClick={startFinalTest}
                                className="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-black py-6 px-8 rounded-3xl shadow-xl hover:shadow-2xl transition-all transform hover:scale-[1.01] flex items-center justify-center gap-4 text-2xl"
                            >
                                <IconTrophy />
                                 住 (15 砖转)
                                <IconArrowLeft />
                            </button>
                            <p className="text-center text-gray-500 mt-4 text-lg"> 转专?  转 注爪 注  专!</p>
                        </div>
                    </div>
                );
            }

            // 住 
            if (view === 'learn') {
                const lesson = lessons.find(l => l.id === activeLevel);
                return (
                    <div className="max-w-4xl mx-auto px-4 py-8">
                        <button onClick={backToMenu} className="mb-8 text-gray-500 hover:text-indigo-600 font-bold flex items-center gap-2 transition-colors text-lg">
                            <IconArrowLeft className="rotate-180" /> 专 转驻专
                        </button>
                        <LessonView lesson={lesson} onComplete={() => setView('quiz')} />
                    </div>
                );
            }

            // 住 转专 专
            if (view === 'quiz') {
                return (
                    <div className="max-w-4xl mx-auto px-4 py-8">
                        <button onClick={backToMenu} className="mb-8 text-gray-500 hover:text-indigo-600 font-bold flex items-center gap-2 transition-colors text-lg">
                            <IconArrowLeft className="rotate-180" /> 专 转驻专
                        </button>
                        <QuizView level={activeLevel} onBack={backToMenu} />
                    </div>
                );
            }

            // 住  住
            if (view === 'final_test') {
                return (
                    <div className="max-w-4xl mx-auto px-4 py-8">
                        <button onClick={backToMenu} className="mb-8 text-gray-500 hover:text-indigo-600 font-bold flex items-center gap-2 transition-colors text-lg">
                            <IconArrowLeft className="rotate-180" /> 住 专 转驻专
                        </button>
                        <FinalTestView onBack={backToMenu} />
                    </div>
                );
            }
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>